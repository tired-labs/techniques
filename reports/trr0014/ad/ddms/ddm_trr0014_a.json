{
  "style": {
    "font-family": "sans-serif",
    "background-color": "#ffffff",
    "background-image": "",
    "background-size": "100%",
    "node-color": "#ffffff",
    "border-width": 4,
    "border-color": "#000000",
    "radius": 50,
    "node-padding": 5,
    "node-margin": 2,
    "outside-position": "auto",
    "node-icon-image": "",
    "node-background-image": "",
    "icon-position": "inside",
    "icon-size": 64,
    "caption-position": "inside",
    "caption-max-width": 200,
    "caption-color": "#000000",
    "caption-font-size": 16,
    "caption-font-weight": "normal",
    "label-position": "outside",
    "label-display": "pill",
    "label-color": "#000000",
    "label-background-color": "#ffffff",
    "label-border-color": "#000000",
    "label-border-width": 2,
    "label-font-size": 14,
    "label-padding": 5,
    "label-margin": 4,
    "directionality": "directed",
    "detail-position": "inline",
    "detail-orientation": "parallel",
    "arrow-width": 5,
    "arrow-color": "#000000",
    "margin-start": 5,
    "margin-end": 5,
    "margin-peer": 20,
    "attachment-start": "normal",
    "attachment-end": "normal",
    "relationship-icon-image": "",
    "type-color": "#000000",
    "type-background-color": "#ffffff",
    "type-border-color": "#000000",
    "type-border-width": 0,
    "type-font-size": 16,
    "type-padding": 5,
    "property-position": "outside",
    "property-alignment": "colon",
    "property-color": "#000000",
    "property-font-size": 16,
    "property-font-weight": "normal"
  },
  "nodes": [
    {
      "id": "n0",
      "position": {
        "x": 795.1044428244486,
        "y": 480.5807883776751
      },
      "caption": "Send LDAP Request",
      "labels": [
        "Network Monitoring"
      ],
      "properties": {
        "Action": "LDAP Add/Modify"
      },
      "style": {
        "border-color": "#68bc00",
        "caption-font-size": 16,
        "property-font-size": 12
      }
    },
    {
      "id": "n1",
      "position": {
        "x": 1295.6752362058862,
        "y": 480.5807883776751
      },
      "caption": "Receive LDAP Request",
      "labels": [],
      "properties": {
        "Host": "DC",
        "Port": "389 or 636",
        "Protocol": "LDAP or LDAPS"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n2",
      "position": {
        "x": 795.1044428244486,
        "y": 272.2130004814044
      },
      "caption": "Create SPNs",
      "labels": [],
      "properties": {
        "Host": "any non-DC",
        "Purpose": "Create SPNs in directory for rogue DC"
      },
      "style": {
        "border-color": "#68bc00",
        "caption-font-size": 16
      }
    },
    {
      "id": "n3",
      "position": {
        "x": 1295.6752362058862,
        "y": 50.00000000000003
      },
      "caption": "Modify Computer Object",
      "labels": [
        "Event 4742",
        "Event 5136"
      ],
      "properties": {
        "Host": "DC",
        "Object": "SPN",
        "Parent Object": "Computer",
        "SPN1": "Global Catalog Service Class (\"GC/\")",
        "SPN2": "DRS Service Class (GUID E3514235....)",
        "Operation": "SPN Added"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n4",
      "position": {
        "x": 75,
        "y": 483.8860886142382
      },
      "caption": "Call RPC",
      "labels": [
        "Network Monitoring"
      ],
      "properties": {
        "RPC": "IDL_DRSAddEntry",
        "OpNum": "17",
        "Interface": "MS-DRSR",
        "Host": "any non-DC",
        "Objects": "Server, nTDSDSA",
        "Transport": "ncacn_ip_tcp"
      },
      "style": {
        "border-color": "#68bc00",
        "caption-font-size": 16,
        "property-font-size": 12
      }
    },
    {
      "id": "n5",
      "position": {
        "x": 75,
        "y": 288.3696191201975
      },
      "caption": "Create Server & NTDS Settings Object",
      "labels": [],
      "properties": {
        "Host": "any non-DC",
        "Purpose": "Insert rogue DC into replication topology"
      },
      "style": {
        "border-color": "#68bc00",
        "caption-font-size": 16
      }
    },
    {
      "id": "n6",
      "position": {
        "x": 474.5742333664369,
        "y": 483.8860886142382
      },
      "caption": "Receive RPC",
      "labels": [],
      "properties": {
        "Host": "DC",
        "Port": "135"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n7",
      "position": {
        "x": 474.5742333664369,
        "y": 272.2130004814044
      },
      "caption": "Add Directory Object",
      "labels": [
        "Event 4662",
        "Event 5137"
      ],
      "properties": {
        "Host": "DC",
        "Objects": "Server, nTDSDSA",
        "Parent Objects": "serversContainer, Server",
        "Partition": "Configuration"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n8",
      "position": {
        "x": 1600.3639260902412,
        "y": 569.5255762108993
      },
      "caption": "Call RPC",
      "labels": [
        "Event 4982"
      ],
      "properties": {
        "Purpose": "Trigger Replication",
        "RPC": "IDL_DRSReplicaAdd ",
        "OpNum": "5",
        "Interface": "MS-DRSR",
        "Host": "any non-DC",
        "Transport": "ncacn_ip_tcp"
      },
      "style": {
        "border-color": "#68bc00"
      }
    },
    {
      "id": "n9",
      "position": {
        "x": 1951.6749098587609,
        "y": 569.5255762108993
      },
      "caption": "Receive RPC",
      "labels": [],
      "properties": {
        "Host": "DC"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n10",
      "position": {
        "x": 1951.6749098587609,
        "y": 50
      },
      "caption": "Update Replication Topology",
      "labels": [],
      "properties": {
        "Host": "DC",
        "Purpose": "Replicate Changes (triggered by topology change)"
      },
      "style": {
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n11",
      "position": {
        "x": 2161.744767440953,
        "y": 600.985069507665
      },
      "caption": "Call RPC",
      "labels": [
        "Event 4935",
        "Event 4936"
      ],
      "properties": {
        "RPC": "IDL_DRSGetNCChanges",
        "OpNum": "3",
        "Interface": "MS-DRSR",
        "Transport": "ncacn_ip_tcp",
        "Host": "DC"
      },
      "style": {
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n12",
      "position": {
        "x": 2445.95911837377,
        "y": 600.985069507665
      },
      "caption": "Receive RPC",
      "labels": [],
      "properties": {
        "Host": "any non-DC"
      },
      "style": {
        "border-color": "#68bc00"
      }
    },
    {
      "id": "n13",
      "position": {
        "x": 2445.95911837377,
        "y": 285.06431888363466
      },
      "caption": "Send Changes",
      "labels": [],
      "properties": {
        "Host": "any non-DC"
      },
      "style": {
        "border-color": "#68bc00"
      }
    },
    {
      "id": "n14",
      "position": {
        "x": 2716.79826987965,
        "y": 285.06431888363466
      },
      "caption": "Remove Directory Objects",
      "labels": [],
      "properties": {
        "Purpose": "Remove Rogue DC"
      },
      "style": {
        "border-color": "#68bc00"
      }
    },
    {
      "id": "n15",
      "position": {
        "x": 2716.79826987965,
        "y": 483.3838656116247
      },
      "caption": "Send LDAP Request",
      "labels": [
        "Network Monitoring"
      ],
      "properties": {
        "Action": "LDAP Delete, Modify"
      },
      "style": {
        "border-color": "#68bc00",
        "caption-font-size": 16,
        "property-font-size": 12
      }
    },
    {
      "id": "n16",
      "position": {
        "x": 3074.1916867842588,
        "y": 480.5807883776751
      },
      "caption": "Receive LDAP Request",
      "labels": [],
      "properties": {
        "Host": "DC",
        "Port": "389"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n17",
      "position": {
        "x": 3074.1916867842588,
        "y": 285.06431888363466
      },
      "caption": "Modify Computer Object",
      "labels": [
        "Event 4742",
        "Event 4929",
        "Event 5141"
      ],
      "properties": {
        "Host": "DC",
        "Objects": "SPN, nTDSDSA, Server",
        "Parent Object": "Computer, Server, siteContainer",
        "Partition": "Configuration",
        "Operation": "SPN & Objects Deleted"
      },
      "style": {
        "caption-font-size": 16,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n18",
      "position": {
        "x": 1600.3639260902412,
        "y": 225.91209712376676
      },
      "caption": "Trigger Topology Update",
      "labels": [],
      "properties": {
        "Purpose": "Trigger replication immediately"
      },
      "style": {
        "border-color": "#68bc00"
      }
    }
  ],
  "relationships": [
    {
      "id": "n0",
      "fromId": "n0",
      "toId": "n1",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n1",
      "fromId": "n2",
      "toId": "n0",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n2",
      "fromId": "n1",
      "toId": "n3",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n3",
      "fromId": "n5",
      "toId": "n4",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n4",
      "fromId": "n6",
      "toId": "n7",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n5",
      "fromId": "n8",
      "toId": "n9",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n6",
      "fromId": "n9",
      "toId": "n10",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n7",
      "fromId": "n11",
      "toId": "n12",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n8",
      "fromId": "n12",
      "toId": "n13",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n9",
      "fromId": "n13",
      "toId": "n14",
      "type": "Optional",
      "properties": {},
      "style": {}
    },
    {
      "id": "n10",
      "fromId": "n10",
      "toId": "n11",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n11",
      "fromId": "n14",
      "toId": "n15",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n12",
      "fromId": "n15",
      "toId": "n16",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n13",
      "fromId": "n16",
      "toId": "n17",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n14",
      "fromId": "n3",
      "toId": "n10",
      "type": "wait up to 15 mins",
      "properties": {},
      "style": {}
    },
    {
      "id": "n15",
      "fromId": "n7",
      "toId": "n2",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n16",
      "fromId": "n4",
      "toId": "n6",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n17",
      "fromId": "n3",
      "toId": "n18",
      "type": "optional",
      "properties": {},
      "style": {}
    },
    {
      "id": "n18",
      "fromId": "n18",
      "toId": "n8",
      "type": "",
      "properties": {},
      "style": {}
    }
  ]
}